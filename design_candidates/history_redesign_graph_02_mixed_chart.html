<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>履歴改修案（グラフ式）2: 複合グラフ型</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .summary-card {
            transition: all 0.3s ease;
        }
        .summary-card:hover {
            transform: scale(1.02);
        }
        .chart-container {
            position: relative;
            margin-bottom: 2rem;
        }
    </style>
</head>
<body class="bg-gray-100 p-4">
    <div class="max-w-5xl mx-auto">
        <h1 class="text-2xl font-bold mb-2 text-gray-800">📊 履歴改修案（グラフ式）2: 複合グラフ型</h1>
        <p class="text-sm text-gray-600 mb-6">特徴: 折れ線グラフ + バーチャート + レーダーチャートで多角的に可視化</p>

        <!-- サマリーカード -->
        <div class="grid grid-cols-2 md:grid-cols-4 gap-3 mb-6">
            <div class="summary-card bg-white p-4 rounded-lg shadow text-center">
                <div class="text-xs text-gray-500 mb-1">分析点数</div>
                <div class="text-2xl font-bold text-green-600">85</div>
                <div class="text-xs text-gray-400">/ 100</div>
            </div>
            <div class="summary-card bg-white p-4 rounded-lg shadow text-center">
                <div class="text-xs text-gray-500 mb-1">カロリー達成率</div>
                <div class="text-2xl font-bold text-blue-600">98%</div>
                <div class="text-xs text-gray-400">2,450 / 2,500kcal</div>
            </div>
            <div class="summary-card bg-white p-4 rounded-lg shadow text-center">
                <div class="text-xs text-gray-500 mb-1">運動習慣率</div>
                <div class="text-2xl font-bold text-red-600">85%</div>
                <div class="text-xs text-gray-400">週6日実施</div>
            </div>
            <div class="summary-card bg-white p-4 rounded-lg shadow text-center">
                <div class="text-xs text-gray-500 mb-1">コンディション</div>
                <div class="text-2xl font-bold text-purple-600">24</div>
                <div class="text-xs text-gray-400">/ 30点</div>
            </div>
        </div>

        <!-- 栄養・食事セクション -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4 flex items-center gap-2 text-green-700">
                <span>📊</span>
                <span>栄養・食事（過去7日間）</span>
            </h2>

            <!-- PFC複合グラフ -->
            <div class="chart-container">
                <h3 class="font-semibold text-gray-700 mb-3">カロリー & PFC バランス</h3>
                <canvas id="pfcComboChart" height="100"></canvas>
            </div>

            <!-- 微量栄養素バーチャート -->
            <div class="chart-container">
                <h3 class="font-semibold text-gray-700 mb-3">微量栄養素達成率（ビタミン・ミネラル）</h3>
                <canvas id="microNutrientsChart" height="80"></canvas>
            </div>

            <!-- 栄養スコアレーダーチャート -->
            <div class="chart-container">
                <h3 class="font-semibold text-gray-700 mb-3">栄養バランスレーダー（最新日）</h3>
                <div class="max-w-md mx-auto">
                    <canvas id="nutritionRadarChart"></canvas>
                </div>
            </div>
        </div>

        <!-- トレーニングセクション -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4 flex items-center gap-2 text-red-700">
                <span>💪</span>
                <span>トレーニング（過去4週間）</span>
            </h2>

            <!-- RM記録推移（複合グラフ） -->
            <div class="chart-container">
                <h3 class="font-semibold text-gray-700 mb-3">🏋️ 主要種目RM記録推移</h3>
                <canvas id="rmProgressChart" height="100"></canvas>
                <div class="mt-3 grid grid-cols-3 gap-2 text-xs">
                    <div class="bg-blue-50 p-2 rounded text-center">
                        <div class="text-gray-600">ベンチプレス</div>
                        <div class="font-bold text-blue-600">100kg <span class="text-green-600">↑+2kg</span></div>
                    </div>
                    <div class="bg-purple-50 p-2 rounded text-center">
                        <div class="text-gray-600">スクワット</div>
                        <div class="font-bold text-purple-600">120kg</div>
                    </div>
                    <div class="bg-orange-50 p-2 rounded text-center">
                        <div class="text-gray-600">デッドリフト</div>
                        <div class="font-bold text-orange-600">150kg <span class="text-green-600">↑+5kg</span></div>
                    </div>
                </div>
            </div>

            <!-- 運動習慣カレンダー風バーチャート -->
            <div class="chart-container">
                <h3 class="font-semibold text-gray-700 mb-3">📈 週間運動実施状況</h3>
                <canvas id="exerciseWeeklyChart" height="80"></canvas>
                <div class="mt-2 text-center text-sm">
                    <span class="font-bold text-green-600">85%達成</span>
                    <span class="text-gray-500 ml-2">（7日中6日実施）</span>
                </div>
            </div>
        </div>

        <!-- コンディションセクション -->
        <div class="bg-white rounded-lg shadow-lg p-6 mb-6">
            <h2 class="text-xl font-bold mb-4 flex items-center gap-2 text-blue-700">
                <span>🧘</span>
                <span>コンディション</span>
            </h2>

            <!-- コンディションスコア推移 -->
            <div class="chart-container">
                <h3 class="font-semibold text-gray-700 mb-3">🎯 総合コンディションスコア（最大30点）</h3>
                <canvas id="conditionTrendChart" height="80"></canvas>
            </div>

            <!-- コンディション詳細レーダー -->
            <div class="chart-container">
                <h3 class="font-semibold text-gray-700 mb-3">詳細コンディションレーダー（最新日）</h3>
                <div class="max-w-md mx-auto">
                    <canvas id="conditionRadarChart"></canvas>
                </div>
            </div>
        </div>

        <!-- メリット・デメリット -->
        <div class="bg-white rounded-lg shadow-md p-4">
            <h3 class="font-bold text-lg mb-3 text-gray-800">✅ メリット</h3>
            <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700 mb-4">
                <li><strong>複数の視点</strong>から同時にデータを把握できる</li>
                <li>レーダーチャートで<strong>バランスの偏り</strong>が一目瞭然</li>
                <li>サマリーカードで重要指標を即座に確認</li>
                <li>折れ線 + バー + レーダーの組み合わせで<strong>飽きないUI</strong></li>
            </ul>
            <h3 class="font-bold text-lg mb-3 text-gray-800">⚠️ デメリット</h3>
            <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700">
                <li>グラフの種類が多く、初見では理解に時間がかかる可能性</li>
                <li>レーダーチャートは数値の絶対値がわかりにくい</li>
            </ul>
        </div>
    </div>

    <script>
        const chartColors = {
            green: 'rgb(34, 197, 94)',
            blue: 'rgb(59, 130, 246)',
            red: 'rgb(239, 68, 68)',
            yellow: 'rgb(245, 158, 11)',
            purple: 'rgb(168, 85, 247)',
            cyan: 'rgb(6, 182, 212)',
            orange: 'rgb(249, 115, 22)'
        };

        const labels7Days = ['月', '火', '水', '木', '金', '土', '日'];
        const labels4Weeks = ['第1週', '第2週', '第3週', '第4週'];

        // PFC複合グラフ（折れ線 + バー）
        new Chart(document.getElementById('pfcComboChart'), {
            type: 'bar',
            data: {
                labels: labels7Days,
                datasets: [
                    {
                        type: 'line',
                        label: 'カロリー (kcal)',
                        data: [2400, 2450, 2500, 2420, 2380, 2460, 2480],
                        borderColor: chartColors.blue,
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        yAxisID: 'y1',
                        tension: 0.4
                    },
                    {
                        label: 'タンパク質 (g)',
                        data: [145, 150, 155, 148, 142, 152, 150],
                        backgroundColor: chartColors.cyan,
                        yAxisID: 'y'
                    },
                    {
                        label: '脂質 (g)',
                        data: [60, 65, 68, 63, 62, 64, 65],
                        backgroundColor: chartColors.yellow,
                        yAxisID: 'y'
                    },
                    {
                        label: '糖質 (g)',
                        data: [280, 285, 290, 280, 275, 290, 295],
                        backgroundColor: chartColors.green,
                        yAxisID: 'y'
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: { legend: { display: true, position: 'bottom' } },
                scales: {
                    y: { type: 'linear', position: 'left', beginAtZero: true },
                    y1: { type: 'linear', position: 'right', beginAtZero: false, grid: { drawOnChartArea: false } }
                }
            }
        });

        // 微量栄養素バーチャート
        new Chart(document.getElementById('microNutrientsChart'), {
            type: 'bar',
            data: {
                labels: labels7Days,
                datasets: [
                    {
                        label: 'ビタミン達成率 (%)',
                        data: [75, 78, 82, 80, 76, 79, 78],
                        backgroundColor: chartColors.purple
                    },
                    {
                        label: 'ミネラル達成率 (%)',
                        data: [80, 82, 85, 83, 79, 84, 82],
                        backgroundColor: chartColors.orange
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: { legend: { display: true, position: 'bottom' } },
                scales: {
                    y: { beginAtZero: true, max: 100 }
                }
            }
        });

        // 栄養バランスレーダーチャート
        new Chart(document.getElementById('nutritionRadarChart'), {
            type: 'radar',
            data: {
                labels: ['カロリー', 'タンパク質', '脂質', '糖質', '食物繊維', 'ビタミン', 'ミネラル'],
                datasets: [{
                    label: '達成率 (%)',
                    data: [98, 94, 93, 93, 83, 78, 82],
                    backgroundColor: 'rgba(34, 197, 94, 0.2)',
                    borderColor: chartColors.green,
                    pointBackgroundColor: chartColors.green,
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: chartColors.green
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 100,
                        ticks: { stepSize: 20 }
                    }
                }
            }
        });

        // RM記録推移
        new Chart(document.getElementById('rmProgressChart'), {
            type: 'line',
            data: {
                labels: labels4Weeks,
                datasets: [
                    {
                        label: 'ベンチプレス 1RM (kg)',
                        data: [95, 97, 98, 100],
                        borderColor: chartColors.blue,
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'スクワット 5RM (kg)',
                        data: [115, 117, 118, 120],
                        borderColor: chartColors.purple,
                        backgroundColor: 'rgba(168, 85, 247, 0.1)',
                        fill: true,
                        tension: 0.4
                    },
                    {
                        label: 'デッドリフト 3RM (kg)',
                        data: [140, 143, 145, 150],
                        borderColor: chartColors.orange,
                        backgroundColor: 'rgba(249, 115, 22, 0.1)',
                        fill: true,
                        tension: 0.4
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: { legend: { display: true, position: 'bottom' } }
            }
        });

        // 週間運動実施状況
        new Chart(document.getElementById('exerciseWeeklyChart'), {
            type: 'bar',
            data: {
                labels: labels7Days,
                datasets: [{
                    label: '運動実施',
                    data: [1, 1, 0, 1, 1, 1, 1],
                    backgroundColor: labels7Days.map((_, i) => [1, 1, 0, 1, 1, 1, 1][i] ? chartColors.green : chartColors.red)
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true, max: 1, ticks: { stepSize: 1, callback: (val) => val === 1 ? '実施' : '未実施' } }
                }
            }
        });

        // コンディションスコア推移
        new Chart(document.getElementById('conditionTrendChart'), {
            type: 'line',
            data: {
                labels: labels7Days,
                datasets: [{
                    label: 'コンディションスコア',
                    data: [22, 24, 26, 24, 23, 25, 24],
                    borderColor: chartColors.blue,
                    backgroundColor: 'rgba(59, 130, 246, 0.2)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: { legend: { display: false } },
                scales: {
                    y: { beginAtZero: true, max: 30 }
                }
            }
        });

        // コンディション詳細レーダー
        new Chart(document.getElementById('conditionRadarChart'), {
            type: 'radar',
            data: {
                labels: ['睡眠の質', '食欲', '集中力'],
                datasets: [{
                    label: 'スコア',
                    data: [8, 8, 8],
                    backgroundColor: 'rgba(59, 130, 246, 0.2)',
                    borderColor: chartColors.blue,
                    pointBackgroundColor: chartColors.blue,
                    pointBorderColor: '#fff',
                    pointHoverBackgroundColor: '#fff',
                    pointHoverBorderColor: chartColors.blue
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                scales: {
                    r: {
                        beginAtZero: true,
                        max: 10,
                        ticks: { stepSize: 2 }
                    }
                }
            }
        });
    </script>
</body>
</html>