# 履歴改修デザイン候補（グラフ式）

## 概要

現在の履歴機能をグラフ式にリニューアルし、直感的にトレンドを把握できる3つのデザイン候補を提案します。
各案はChart.jsを使用して実装し、モバイルフレンドリーなレスポンシブデザインになっています。

## 表示項目（全候補共通）

### 栄養・食事カテゴリ
1. **分析点数**（0-100点）- 過去7日間の推移
2. **摂取カロリー**（kcal）- 目標との比較
3. **タンパク質**（g、達成率%）
4. **脂質**（g、達成率%）
5. **糖質**（g、達成率%）
6. **食物繊維**（g、達成率%）
7. **ビタミン総合達成率**（%）
8. **ミネラル総合達成率**（%）

### トレーニングカテゴリ
1. **回数別RM記録**（種目・RM・重量・先週比）- 過去4週間の推移
2. **運動習慣率**（%、週間実施日数）- カレンダー風表示

### コンディションカテゴリ
1. **コンディションスコア**（最大30点）- 過去7日間の推移
2. **詳細内訳**（睡眠の質・食欲・集中力、各/10）

---

## デザイン候補

### 案1: 折れ線グラフメイン型
**ファイル**: `history_redesign_graph_01_line_chart.html`

**特徴**:
- 各指標ごとに折れ線グラフを表示
- カテゴリごとに色分けされたセクション（栄養=緑、トレーニング=赤、コンディション=青）
- 目標値との比較が容易

**UI構成**:
```
📊 栄養・食事（緑色セクション）
  ├─ 分析点数（折れ線グラフ）
  ├─ カロリー & タンパク質（2カラムグリッド）
  ├─ 脂質 & 糖質（2カラムグリッド）
  └─ ビタミン & ミネラル（2カラムグリッド）

💪 トレーニング（赤色セクション）
  ├─ RM記録推移（折れ線グラフ × 3種目）
  └─ 運動習慣率（バーチャート）

🧘 コンディション（青色セクション）
  ├─ 総合スコア（折れ線グラフ）
  └─ 詳細内訳（カード × 3項目）
```

**メリット**:
- ✅ 各指標の**トレンドが一目瞭然**
- ✅ 折れ線グラフで**変化の傾向**を直感的に理解
- ✅ 目標値との比較がしやすい（グラフに基準線を表示可能）
- ✅ 複数の指標を同時に比較できる

**デメリット**:
- ⚠️ グラフが多いため、スクロール量が増える
- ⚠️ データが少ない期間では折れ線が見づらい可能性

---

### 案2: 複合グラフ型
**ファイル**: `history_redesign_graph_02_mixed_chart.html`

**特徴**:
- 折れ線 + バー + レーダーチャートの組み合わせ
- サマリーカードで重要指標を即座に表示
- 多角的な視点でデータを可視化

**UI構成**:
```
📊 サマリーカード（4項目横並び）
  - 分析点数 / カロリー達成率 / 運動習慣率 / コンディション

📊 栄養・食事
  ├─ PFC複合グラフ（折れ線 × カロリー + バー × PFC）
  ├─ 微量栄養素バーチャート（ビタミン・ミネラル）
  └─ 栄養バランスレーダー（7項目）

💪 トレーニング
  ├─ RM記録推移（折れ線グラフ × 3種目）
  └─ 週間運動実施状況（バーチャート）

🧘 コンディション
  ├─ 総合スコア推移（折れ線グラフ）
  └─ 詳細レーダー（3項目）
```

**メリット**:
- ✅ **複数の視点**から同時にデータを把握できる
- ✅ レーダーチャートで**バランスの偏り**が一目瞭然
- ✅ サマリーカードで重要指標を即座に確認
- ✅ 折れ線 + バー + レーダーの組み合わせで**飽きないUI**

**デメリット**:
- ⚠️ グラフの種類が多く、初見では理解に時間がかかる可能性
- ⚠️ レーダーチャートは数値の絶対値がわかりにくい

---

### 案3: ダッシュボードスタイル型 ⭐ **推奨**
**ファイル**: `history_redesign_graph_03_dashboard_style.html`

**特徴**:
- 各指標をカード化し、ミニグラフ（スパークライン）で即座にトレンド把握
- Google Analytics、Apple Health風のモダンなダッシュボードUI
- カードクリックで詳細グラフに展開可能（拡張性が高い）

**UI構成**:
```
📊 栄養・食事（8カードグリッド、4列 × 2行）
  各カード:
    - 大きな数値表示（例: 85点）
    - 目標との比較（例: / 100点、94%）
    - 前日比の変化（例: +3、+5g）
    - ミニグラフ（スパークライン）

💪 トレーニング（2カードグリッド、2列 × 1行）
  左カード: RM記録
    - 3種目の詳細（種目・重量・先週比）
    - RM推移グラフ
  右カード: 運動習慣率
    - 大きな達成率表示（85%）
    - ドーナツチャート
    - 週間カレンダー風バー表示

🧘 コンディション（2カードグリッド、2列 × 1行）
  左カード: 総合スコア
    - 大きなスコア表示（24/30点）
    - 推移グラフ
  右カード: 詳細内訳
    - 3項目（睡眠・食欲・集中力）
    - プログレスバー + 数値表示
```

**メリット**:
- ✅ **一目で全体像を把握**できるカードレイアウト
- ✅ ミニグラフ（スパークライン）で**トレンドを即座に確認**
- ✅ 前日比の変化（↑+2kg など）が視覚的にわかりやすい
- ✅ **モバイルでも快適**（カードは縦スクロールに最適）
- ✅ クリックで詳細グラフに展開可能（拡張性が高い）

**デメリット**:
- ⚠️ カード数が多いため、初期表示に若干時間がかかる可能性
- ⚠️ ミニグラフは詳細な数値が見づらい（クリックで詳細表示が必要）

---

## 推奨案: 案3（ダッシュボードスタイル型）

### 推奨理由

1. **直感性**: スパークライン + 大きな数値で瞬時に状況把握
2. **情報密度**: 8項目を1画面に収め、スクロール不要
3. **モバイル最適化**: カードUIはタップしやすく、レスポンシブ
4. **拡張性**: カードクリックで詳細モーダル表示など、機能追加が容易
5. **現代的**: Google Analytics、Apple Health風のダッシュボードUI

---

## 実装技術

### 使用ライブラリ
- **Chart.js** (v3.x): グラフ描画ライブラリ
- **Tailwind CSS**: スタイリング
- **Vanilla JavaScript**: インタラクション

### グラフの種類

| グラフタイプ | 用途 | 使用箇所 |
|------------|------|---------|
| 折れ線グラフ | 時系列データの推移表示 | 分析点数、カロリー、PFC、コンディションスコア |
| バーチャート | カテゴリ別比較 | 微量栄養素、運動実施状況 |
| レーダーチャート | 多項目のバランス表示 | 栄養バランス、コンディション詳細 |
| ドーナツチャート | 割合表示 | 運動習慣率 |
| スパークライン | ミニトレンド表示 | ダッシュボードカード |

---

## プレビュー方法

各HTMLファイルをブラウザで開いてデザインを確認してください。

```bash
# ローカルサーバーで確認
python -m http.server 8000

# ブラウザで以下を開く
# http://localhost:8000/design_candidates/history_redesign_graph_01_line_chart.html
# http://localhost:8000/design_candidates/history_redesign_graph_02_mixed_chart.html
# http://localhost:8000/design_candidates/history_redesign_graph_03_dashboard_style.html
```

---

## 実装時の注意事項

### データ構造例

```javascript
const historyGraphData = {
  period: '2025-10-08 ~ 2025-10-14', // 7日間
  nutrition: {
    analysisScores: [75, 82, 88, 85, 92, 80, 85],
    calories: {
      actual: [2400, 2450, 2500, 2420, 2380, 2460, 2480],
      target: 2500,
      latest: 2450,
      change: +20 // 前日比
    },
    protein: {
      actual: [145, 150, 155, 148, 142, 152, 150],
      target: 160,
      latest: 150,
      rate: 94,
      change: +5
    },
    // 脂質、糖質、食物繊維も同様
    vitaminRate: { values: [75, 78, 82, 80, 76, 79, 78], latest: 78 },
    mineralRate: { values: [80, 82, 85, 83, 79, 84, 82], latest: 82 }
  },
  training: {
    rmRecords: [
      {
        exercise: 'ベンチプレス',
        rm: 1,
        history: [95, 97, 98, 100], // 週ごと
        latest: 100,
        change: +2
      },
      // スクワット、デッドリフトも同様
    ],
    exerciseHabitRate: 85,
    weeklyDays: [true, true, false, true, true, true, true] // 月~日
  },
  condition: {
    totalScores: [22, 24, 26, 24, 23, 25, 24],
    latest: 24,
    maxScore: 30,
    details: {
      sleep: 8,
      appetite: 8,
      focus: 8
    }
  }
};
```

### パフォーマンス最適化

1. **遅延読み込み**: スクロール位置に応じてグラフを描画
2. **キャッシング**: 一度描画したグラフはキャッシュ
3. **レスポンシブ**: ウィンドウサイズ変更時の再描画最適化

### アクセシビリティ

- グラフの代替テキスト（`aria-label`）を設定
- キーボード操作でカード選択可能
- カラーブラインド対応の配色

---

## 関連ファイル

- **実装対象**: `components/05_analysis.js`（HistoryView コンポーネント）
- **参考**: 現在の履歴表示（components/05_analysis.js:865-1200）

---

## 次のステップ

1. **ユーザーフィードバック**: 3案からユーザーが選択
2. **詳細設計**: 選択された案の詳細仕様を策定
3. **実装**: React + Chart.jsで実装
4. **テスト**: 各デバイス・ブラウザで動作確認

---

**作成日**: 2025年10月15日
**更新日**: 2025年10月15日
