<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>履歴改修案（グラフ式）3: ダッシュボードスタイル型 v4（最終版）</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        .tab-button {
            transition: all 0.3s ease;
            position: relative;
        }
        .tab-button.active {
            font-weight: 600;
        }
        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: currentColor;
        }
        .sub-tab-button {
            transition: all 0.2s ease;
        }
        .sub-tab-button.active {
            transform: scale(1.05);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .chart-container {
            animation: fadeIn 0.4s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="bg-gray-100 p-4">
    <div class="max-w-6xl mx-auto">
        <h1 class="text-2xl font-bold mb-2 text-gray-800">📊 履歴改修案（グラフ式）3: ダッシュボードスタイル型 v4</h1>
        <div class="bg-yellow-100 border-l-4 border-yellow-500 p-3 mb-6">
            <p class="text-sm font-semibold text-yellow-800">⭐ 推奨案（最終版）</p>
            <p class="text-xs text-yellow-700">アイコン統一、単位修正、LBM・指示書達成率追加提案付き</p>
        </div>

        <!-- メインコンテナ -->
        <div class="bg-white rounded-lg shadow-lg overflow-hidden">
            <!-- 大カテゴリタブ -->
            <div class="flex border-b bg-gray-50">
                <button
                    class="tab-button flex-1 py-4 px-6 text-center transition active text-green-700 bg-white border-b-0"
                    onclick="selectMainCategory('nutrition')">
                    <div class="flex items-center justify-center gap-2">
                        <i data-lucide="flame" class="w-5 h-5"></i>
                        <div>
                            <div class="text-sm font-semibold">栄養・食事</div>
                            <div class="text-xs opacity-75">85点</div>
                        </div>
                    </div>
                </button>
                <button
                    class="tab-button flex-1 py-4 px-6 text-center transition text-gray-600"
                    onclick="selectMainCategory('training')">
                    <div class="flex items-center justify-center gap-2">
                        <i data-lucide="dumbbell" class="w-5 h-5"></i>
                        <div>
                            <div class="text-sm font-semibold">トレーニング</div>
                            <div class="text-xs opacity-75">88点</div>
                        </div>
                    </div>
                </button>
                <button
                    class="tab-button flex-1 py-4 px-6 text-center transition text-gray-600"
                    onclick="selectMainCategory('condition')">
                    <div class="flex items-center justify-center gap-2">
                        <i data-lucide="heart" class="w-5 h-5"></i>
                        <div>
                            <div class="text-sm font-semibold">コンディション</div>
                            <div class="text-xs opacity-75">24/30点</div>
                        </div>
                    </div>
                </button>
            </div>

            <!-- 小カテゴリタブ（栄養・食事） -->
            <div id="nutrition-subtabs" class="sub-tabs flex flex-wrap gap-2 p-4 bg-green-50 border-b">
                <button class="sub-tab-button active px-4 py-2 bg-white text-green-700 rounded-lg text-sm font-semibold border-2 border-green-500" onclick="selectSubCategory('nutrition', 'calories')">
                    🔥 カロリー
                </button>
                <button class="sub-tab-button px-4 py-2 bg-white text-gray-700 rounded-lg text-sm font-semibold border-2 border-transparent hover:border-gray-300" onclick="selectSubCategory('nutrition', 'protein')">
                    🥩 タンパク質
                </button>
                <button class="sub-tab-button px-4 py-2 bg-white text-gray-700 rounded-lg text-sm font-semibold border-2 border-transparent hover:border-gray-300" onclick="selectSubCategory('nutrition', 'fat')">
                    🧈 脂質
                </button>
                <button class="sub-tab-button px-4 py-2 bg-white text-gray-700 rounded-lg text-sm font-semibold border-2 border-transparent hover:border-gray-300" onclick="selectSubCategory('nutrition', 'carbs')">
                    🍚 糖質
                </button>
                <button class="sub-tab-button px-4 py-2 bg-white text-gray-700 rounded-lg text-sm font-semibold border-2 border-transparent hover:border-gray-300" onclick="selectSubCategory('nutrition', 'fiber')">
                    🥬 食物繊維
                </button>
                <button class="sub-tab-button px-4 py-2 bg-white text-gray-700 rounded-lg text-sm font-semibold border-2 border-transparent hover:border-gray-300" onclick="selectSubCategory('nutrition', 'vitamin')">
                    💊 ビタミン
                </button>
                <button class="sub-tab-button px-4 py-2 bg-white text-gray-700 rounded-lg text-sm font-semibold border-2 border-transparent hover:border-gray-300" onclick="selectSubCategory('nutrition', 'mineral')">
                    ⚡ ミネラル
                </button>
            </div>

            <!-- 小カテゴリタブ（トレーニング） -->
            <div id="training-subtabs" class="sub-tabs hidden flex-wrap gap-2 p-4 bg-red-50 border-b">
                <button class="sub-tab-button active px-4 py-2 bg-white text-red-700 rounded-lg text-sm font-semibold border-2 border-red-500" onclick="selectSubCategory('training', 'rm')">
                    🏋️ RM記録
                </button>
                <button class="sub-tab-button px-4 py-2 bg-white text-gray-700 rounded-lg text-sm font-semibold border-2 border-transparent hover:border-gray-300" onclick="selectSubCategory('training', 'habit')">
                    📈 運動習慣率
                </button>
            </div>

            <!-- 小カテゴリタブ（コンディション） -->
            <div id="condition-subtabs" class="sub-tabs hidden flex-wrap gap-2 p-4 bg-blue-50 border-b">
                <button class="sub-tab-button active px-4 py-2 bg-white text-blue-700 rounded-lg text-sm font-semibold border-2 border-blue-500" onclick="selectSubCategory('condition', 'total')">
                    🎯 総合スコア
                </button>
                <button class="sub-tab-button px-4 py-2 bg-white text-gray-700 rounded-lg text-sm font-semibold border-2 border-transparent hover:border-gray-300" onclick="selectSubCategory('condition', 'sleep')">
                    😴 睡眠の質
                </button>
                <button class="sub-tab-button px-4 py-2 bg-white text-gray-700 rounded-lg text-sm font-semibold border-2 border-transparent hover:border-gray-300" onclick="selectSubCategory('condition', 'appetite')">
                    🍽️ 食欲
                </button>
                <button class="sub-tab-button px-4 py-2 bg-white text-gray-700 rounded-lg text-sm font-semibold border-2 border-transparent hover:border-gray-300" onclick="selectSubCategory('condition', 'focus')">
                    🧠 集中力
                </button>
            </div>

            <!-- 詳細グラフ表示エリア -->
            <div class="p-6">
                <div id="chart-display" class="chart-container">
                    <!-- ヘッダー -->
                    <div class="flex justify-between items-center mb-6">
                        <div>
                            <h3 id="chart-title" class="text-3xl font-bold text-gray-800">🔥 カロリー</h3>
                            <p id="chart-period" class="text-sm text-gray-500 mt-1">過去7日間の推移</p>
                        </div>
                        <div class="text-right">
                            <div id="chart-value" class="text-5xl font-bold text-blue-600">2,450</div>
                            <div id="chart-unit" class="text-sm text-gray-500 mt-1">kcal</div>
                            <div id="chart-target" class="text-sm font-semibold text-green-600 mt-2">目標: 2,500kcal (98%)</div>
                        </div>
                    </div>

                    <!-- グラフ -->
                    <canvas id="main-chart" height="100"></canvas>

                    <!-- 統計情報 -->
                    <div id="stats-container" class="mt-6 grid grid-cols-3 gap-4 text-center">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="text-xs text-gray-600 mb-1">平均</div>
                            <div id="stat-avg" class="text-2xl font-bold text-blue-600">2,420</div>
                            <div id="stat-avg-unit" class="text-xs text-gray-500">kcal</div>
                        </div>
                        <div class="bg-green-50 p-4 rounded-lg">
                            <div class="text-xs text-gray-600 mb-1">最高</div>
                            <div id="stat-max" class="text-2xl font-bold text-green-600">2,500</div>
                            <div id="stat-max-unit" class="text-xs text-gray-500">kcal</div>
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg">
                            <div class="text-xs text-gray-600 mb-1">最低</div>
                            <div id="stat-min" class="text-2xl font-bold text-orange-600">2,380</div>
                            <div id="stat-min-unit" class="text-xs text-gray-500">kcal</div>
                        </div>
                    </div>

                    <!-- RM記録用の追加情報 -->
                    <div id="rm-info" class="mt-6 grid grid-cols-3 gap-4 hidden">
                        <div class="bg-blue-50 p-4 rounded-lg">
                            <div class="text-xs text-gray-600 mb-1">ベンチプレス 1RM</div>
                            <div class="text-2xl font-bold text-blue-600">100kg</div>
                            <div class="text-sm text-green-600 font-semibold">↑ +2kg</div>
                        </div>
                        <div class="bg-purple-50 p-4 rounded-lg">
                            <div class="text-xs text-gray-600 mb-1">スクワット 5RM</div>
                            <div class="text-2xl font-bold text-purple-600">120kg</div>
                            <div class="text-sm text-gray-400">-</div>
                        </div>
                        <div class="bg-orange-50 p-4 rounded-lg">
                            <div class="text-xs text-gray-600 mb-1">デッドリフト 3RM</div>
                            <div class="text-2xl font-bold text-orange-600">150kg</div>
                            <div class="text-sm text-green-600 font-semibold">↑ +5kg</div>
                        </div>
                    </div>

                    <!-- 運動習慣率用の週間カレンダー -->
                    <div id="habit-calendar" class="mt-6 hidden">
                        <div class="grid grid-cols-7 gap-2">
                            <div class="text-center">
                                <div class="text-xs text-gray-500 mb-2">月</div>
                                <div class="bg-green-500 rounded p-4 text-white font-bold">実施</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xs text-gray-500 mb-2">火</div>
                                <div class="bg-green-500 rounded p-4 text-white font-bold">実施</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xs text-gray-500 mb-2">水</div>
                                <div class="bg-gray-200 rounded p-4 text-gray-500 font-bold">未実施</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xs text-gray-500 mb-2">木</div>
                                <div class="bg-green-500 rounded p-4 text-white font-bold">実施</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xs text-gray-500 mb-2">金</div>
                                <div class="bg-green-500 rounded p-4 text-white font-bold">実施</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xs text-gray-500 mb-2">土</div>
                                <div class="bg-green-500 rounded p-4 text-white font-bold">実施</div>
                            </div>
                            <div class="text-center">
                                <div class="text-xs text-gray-500 mb-2">日</div>
                                <div class="bg-green-500 rounded p-4 text-white font-bold">実施</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- LBM・指示書達成率の追加提案 -->
        <div class="bg-blue-50 border-l-4 border-blue-500 p-4 mt-6">
            <h3 class="font-bold text-blue-800 mb-3">💡 LBM・指示書達成率を追加する場合の提案</h3>

            <div class="space-y-3 text-sm text-blue-900">
                <div class="bg-white p-3 rounded">
                    <h4 class="font-semibold mb-2">案A: 新しい大カテゴリ「パフォーマンス」を追加</h4>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>大カテゴリ</strong>: 栄養・食事 | トレーニング | コンディション | <span class="text-purple-600 font-bold">パフォーマンス</span></li>
                        <li><strong>小カテゴリ（パフォーマンス）</strong>:</li>
                        <ul class="list-circle pl-5 mt-1">
                            <li>💪 LBM（除脂肪体重）- 過去30日間の推移グラフ</li>
                            <li>📋 指示書達成率 - 週間・月間の達成率グラフ</li>
                            <li>🎯 総合分析スコア - 3つのカテゴリの加重平均</li>
                        </ul>
                        <li><strong>アイコン案</strong>: <code>TrendingUp</code> または <code>Award</code></li>
                    </ul>
                </div>

                <div class="bg-white p-3 rounded">
                    <h4 class="font-semibold mb-2">案B: 既存カテゴリに統合</h4>
                    <ul class="list-disc pl-5 space-y-1">
                        <li><strong>LBM → コンディションに追加</strong>
                            <ul class="list-circle pl-5 mt-1">
                                <li>体組成に関連する指標なので、コンディションカテゴリの小カテゴリとして「💪 LBM」を追加</li>
                            </ul>
                        </li>
                        <li><strong>指示書達成率 → トレーニングに追加</strong>
                            <ul class="list-circle pl-5 mt-1">
                                <li>運動習慣率と同じく「実行」に関する指標なので、トレーニングカテゴリの小カテゴリとして「📋 指示書達成率」を追加</li>
                            </ul>
                        </li>
                    </ul>
                </div>

                <div class="bg-white p-3 rounded">
                    <h4 class="font-semibold mb-2">推奨: 案A（新カテゴリ追加）</h4>
                    <p class="text-xs">LBMと指示書達成率は「結果・成果」を表す指標なので、「パフォーマンス」として独立させることで、ユーザーは自分の成長を一目で把握できます。</p>
                </div>
            </div>
        </div>

        <!-- v4の改良ポイント -->
        <div class="bg-white rounded-lg shadow-md p-4 mt-6">
            <h3 class="font-bold text-lg mb-3 text-gray-800">✅ v4の改良ポイント</h3>
            <ul class="list-disc pl-5 space-y-1 text-sm text-gray-700">
                <li><strong>アイコン統一</strong>: アプリと同じLucideアイコンを使用（Flame, Dumbbell, Heart）</li>
                <li><strong>単位修正</strong>: 各指標に応じた正しい単位を統計情報に表示（kcal, g, 点など）</li>
                <li><strong>運動習慣率</strong>: 「実施/未実施」の週間カレンダー表示に変更</li>
                <li><strong>LBM・指示書達成率の追加案</strong>: 新カテゴリ「パフォーマンス」の追加を提案</li>
            </ul>
        </div>
    </div>

    <script>
        // Lucideアイコン初期化
        lucide.createIcons();

        let currentMainCategory = 'nutrition';
        let currentSubCategory = { nutrition: 'calories', training: 'rm', condition: 'total' };
        let mainChart = null;

        // データ定義
        const chartData = {
            nutrition: {
                calories: {
                    values: [2400, 2450, 2500, 2420, 2380, 2460, 2480],
                    label: '🔥 カロリー',
                    unit: 'kcal',
                    color: 'rgb(59, 130, 246)',
                    target: '目標: 2,500kcal (98%)'
                },
                protein: {
                    values: [145, 150, 155, 148, 142, 152, 150],
                    label: '🥩 タンパク質',
                    unit: 'g',
                    color: 'rgb(6, 182, 212)',
                    target: '目標: 160g (94%)'
                },
                fat: {
                    values: [60, 65, 68, 63, 62, 64, 65],
                    label: '🧈 脂質',
                    unit: 'g',
                    color: 'rgb(245, 158, 11)',
                    target: '目標: 70g (93%)'
                },
                carbs: {
                    values: [280, 285, 290, 280, 275, 290, 295],
                    label: '🍚 糖質',
                    unit: 'g',
                    color: 'rgb(34, 197, 94)',
                    target: '目標: 300g (98%)'
                },
                fiber: {
                    values: [23, 24, 25, 25, 24, 24, 25],
                    label: '🥬 食物繊維',
                    unit: 'g',
                    color: 'rgb(132, 204, 22)',
                    target: '目標: 30g (83%)'
                },
                vitamin: {
                    values: [75, 76, 78, 79, 78, 77, 78],
                    label: '💊 ビタミン総合達成率',
                    unit: '%',
                    color: 'rgb(168, 85, 247)',
                    target: '目標: 100%'
                },
                mineral: {
                    values: [80, 81, 82, 83, 82, 81, 82],
                    label: '⚡ ミネラル総合達成率',
                    unit: '%',
                    color: 'rgb(249, 115, 22)',
                    target: '目標: 100%'
                }
            },
            training: {
                rm: {
                    multiLine: true,
                    datasets: [
                        { label: 'ベンチプレス 1RM', data: [95, 97, 98, 100], color: 'rgb(59, 130, 246)' },
                        { label: 'スクワット 5RM', data: [115, 117, 118, 120], color: 'rgb(168, 85, 247)' },
                        { label: 'デッドリフト 3RM', data: [140, 143, 145, 150], color: 'rgb(249, 115, 22)' }
                    ],
                    labels: ['第1週', '第2週', '第3週', '第4週'],
                    title: '🏋️ RM記録推移',
                    period: '過去4週間'
                },
                habit: {
                    values: [1, 1, 0, 1, 1, 1, 1],
                    label: '📈 運動習慣率',
                    unit: '',
                    color: 'rgb(34, 197, 94)',
                    target: '週6日実施 (85%)',
                    isHabit: true
                }
            },
            condition: {
                total: {
                    values: [22, 24, 26, 24, 23, 25, 24],
                    label: '🎯 総合コンディションスコア',
                    unit: '点',
                    color: 'rgb(59, 130, 246)',
                    target: '/ 30点'
                },
                sleep: {
                    values: [7, 8, 9, 8, 7, 8, 8],
                    label: '😴 睡眠の質',
                    unit: '点',
                    color: 'rgb(59, 130, 246)',
                    target: '/ 10点'
                },
                appetite: {
                    values: [7, 8, 8, 8, 7, 8, 8],
                    label: '🍽️ 食欲',
                    unit: '点',
                    color: 'rgb(34, 197, 94)',
                    target: '/ 10点'
                },
                focus: {
                    values: [8, 8, 9, 8, 9, 9, 8],
                    label: '🧠 集中力',
                    unit: '点',
                    color: 'rgb(168, 85, 247)',
                    target: '/ 10点'
                }
            }
        };

        // 大カテゴリ選択
        function selectMainCategory(category) {
            currentMainCategory = category;

            // 大カテゴリタブのアクティブ状態を更新
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active', 'text-green-700', 'text-red-700', 'text-blue-700', 'bg-white', 'border-b-0');
                btn.classList.add('text-gray-600');
            });
            event.currentTarget.classList.add('active', 'bg-white', 'border-b-0');

            if (category === 'nutrition') {
                event.currentTarget.classList.add('text-green-700');
            } else if (category === 'training') {
                event.currentTarget.classList.add('text-red-700');
            } else if (category === 'condition') {
                event.currentTarget.classList.add('text-blue-700');
            }

            // 小カテゴリタブを切り替え
            document.querySelectorAll('.sub-tabs').forEach(el => el.classList.add('hidden'));
            document.getElementById(`${category}-subtabs`).classList.remove('hidden');
            document.getElementById(`${category}-subtabs`).classList.add('flex');

            // 選択中の小カテゴリを表示
            updateChart(category, currentSubCategory[category]);
        }

        // 小カテゴリ選択
        function selectSubCategory(category, subCategory) {
            currentSubCategory[category] = subCategory;

            // 小カテゴリタブのアクティブ状態を更新
            const subtabContainer = document.getElementById(`${category}-subtabs`);
            subtabContainer.querySelectorAll('.sub-tab-button').forEach(btn => {
                btn.classList.remove('active', 'border-green-500', 'border-red-500', 'border-blue-500', 'text-green-700', 'text-red-700', 'text-blue-700');
                btn.classList.add('border-transparent', 'text-gray-700');
            });

            event.currentTarget.classList.add('active');
            event.currentTarget.classList.remove('border-transparent', 'text-gray-700');

            if (category === 'nutrition') {
                event.currentTarget.classList.add('border-green-500', 'text-green-700');
            } else if (category === 'training') {
                event.currentTarget.classList.add('border-red-500', 'text-red-700');
            } else if (category === 'condition') {
                event.currentTarget.classList.add('border-blue-500', 'text-blue-700');
            }

            updateChart(category, subCategory);
        }

        // グラフ更新
        function updateChart(category, subCategory) {
            const data = chartData[category][subCategory];

            // すべての特別表示を非表示
            document.getElementById('rm-info').classList.add('hidden');
            document.getElementById('habit-calendar').classList.add('hidden');
            document.getElementById('stats-container').classList.remove('hidden');

            // RM記録の場合
            if (data.multiLine) {
                document.getElementById('chart-title').textContent = data.title;
                document.getElementById('chart-period').textContent = data.period;
                document.getElementById('chart-value').textContent = '';
                document.getElementById('chart-unit').textContent = '';
                document.getElementById('chart-target').textContent = '';
                document.getElementById('stats-container').classList.add('hidden');
                document.getElementById('rm-info').classList.remove('hidden');

                if (mainChart) mainChart.destroy();
                mainChart = new Chart(document.getElementById('main-chart'), {
                    type: 'line',
                    data: {
                        labels: data.labels,
                        datasets: data.datasets.map(ds => ({
                            label: ds.label,
                            data: ds.data,
                            borderColor: ds.color,
                            backgroundColor: ds.color.replace('rgb', 'rgba').replace(')', ', 0.1)'),
                            tension: 0.4
                        }))
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: { legend: { display: true, position: 'bottom' } }
                    }
                });
                return;
            }

            // 運動習慣率の場合
            if (data.isHabit) {
                document.getElementById('chart-title').textContent = data.label;
                document.getElementById('chart-period').textContent = '過去7日間の実施状況';
                document.getElementById('chart-value').textContent = '6';
                document.getElementById('chart-unit').textContent = '日実施';
                document.getElementById('chart-target').textContent = data.target;
                document.getElementById('stats-container').classList.add('hidden');
                document.getElementById('habit-calendar').classList.remove('hidden');

                if (mainChart) mainChart.destroy();
                mainChart = new Chart(document.getElementById('main-chart'), {
                    type: 'bar',
                    data: {
                        labels: ['月', '火', '水', '木', '金', '土', '日'],
                        datasets: [{
                            label: '運動実施',
                            data: data.values,
                            backgroundColor: data.values.map(v => v === 1 ? data.color : 'rgb(229, 231, 235)')
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: true,
                        plugins: { legend: { display: false } },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 1,
                                ticks: {
                                    stepSize: 1,
                                    callback: (val) => val === 1 ? '実施' : '未実施'
                                }
                            }
                        }
                    }
                });
                return;
            }

            // 通常の指標
            document.getElementById('chart-title').textContent = data.label;
            document.getElementById('chart-period').textContent = '過去7日間の推移';
            document.getElementById('chart-value').textContent = data.values[data.values.length - 1];
            document.getElementById('chart-unit').textContent = data.unit;
            document.getElementById('chart-target').textContent = data.target;

            // 統計計算
            const avg = (data.values.reduce((a, b) => a + b, 0) / data.values.length).toFixed(data.unit === '%' ? 1 : 0);
            const max = Math.max(...data.values);
            const min = Math.min(...data.values);

            document.getElementById('stat-avg').textContent = avg;
            document.getElementById('stat-max').textContent = max;
            document.getElementById('stat-min').textContent = min;

            // 統計の単位も更新
            document.getElementById('stat-avg-unit').textContent = data.unit;
            document.getElementById('stat-max-unit').textContent = data.unit;
            document.getElementById('stat-min-unit').textContent = data.unit;

            // グラフ描画
            if (mainChart) mainChart.destroy();

            const labels = ['月', '火', '水', '木', '金', '土', '日'];

            mainChart = new Chart(document.getElementById('main-chart'), {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: data.label,
                        data: data.values,
                        borderColor: data.color,
                        backgroundColor: data.color.replace('rgb', 'rgba').replace(')', ', 0.1)'),
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: { legend: { display: false } }
                }
            });
        }

        // 初期表示
        updateChart('nutrition', 'calories');
    </script>
</body>
</html>